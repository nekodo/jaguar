var cache = {}
function _require(f) {
  return cache[f] || require(f == "./builtins.js" ? process.cwd() + "/" + "compiler/builtins.js" : f);
}
cache["//compiler/prelude.jg"] = (function() {var $add = (_require("./builtins.js")).$add;
var $lt = (_require("./builtins.js")).$lt;
var $eq = (_require("./builtins.js")).$eq;
var $concat = (_require("./builtins.js")).$concat;
var get = (_require("./builtins.js")).get;
var length = (_require("./builtins.js")).length;
var emptyArray = (_require("./builtins.js")).emptyArray;
var push = (_require("./builtins.js")).push;
var enqueue = (_require("./builtins.js")).enqueue;
var slice = (_require("./builtins.js")).slice;
var concat = (_require("./builtins.js")).concat;
var map = (_require("./builtins.js")).map;
var filter = (_require("./builtins.js")).filter;
var foldl = (_require("./builtins.js")).foldl;
var foldl1 = (_require("./builtins.js")).foldl1;
var True = (_require("./builtins.js")).True;
var False = (_require("./builtins.js")).False;
var $Just = function($0){this.$0=$0;this.$tag="Just"};
var Just = function($0){return new $Just($0)};
Just.$tag = "Just";
var $Nothing = function(){this.$tag="Nothing"};
var Nothing = new $Nothing();
Nothing.$tag = "Nothing";
var $Pair = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="Pair"};
var Pair = function($0){return function($1){return new $Pair($0,$1)}};
Pair.$tag = "Pair";
var $Left = function($0){this.$0=$0;this.$tag="Left"};
var Left = function($0){return new $Left($0)};
Left.$tag = "Left";
var $Right = function($0){this.$0=$0;this.$tag="Right"};
var Right = function($0){return new $Right($0)};
Right.$tag = "Right";
var maybe = function(a){return function(b){return function(m){return (function(){var $pm = m;return ($pm.$tag==Just.$tag)?((function(x){return a(x)})($pm.$0)):(($pm.$tag==Nothing.$tag)?((function(){return b})()):(error("pattern match fail")))})()}}};
var fst = function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(a,b){return a})($pm.$0,$pm.$1)):(error("pattern match fail"))})()};
var snd = function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(a,b){return b})($pm.$0,$pm.$1)):(error("pattern match fail"))})()};
var either = function(f){return function(g){return function(e){return (function(){var $pm = e;return ($pm.$tag==Left.$tag)?((function(a){return f(a)})($pm.$0)):(($pm.$tag==Right.$tag)?((function(b){return g(b)})($pm.$0)):(error("pattern match fail")))})()}}};
var splitEither = function(a){return (Pair((map(function(e){return (function(){var $pm = e;return ($pm.$tag==Left.$tag)?((function(a){return a})($pm.$0)):(error("pattern match fail"))})()}))((filter((either(function(_){return true}))(function(_){return false})))(a))))((map(function(e){return (function(){var $pm = e;return ($pm.$tag==Right.$tag)?((function(b){return b})($pm.$0)):(error("pattern match fail"))})()}))((filter((either(function(_){return false}))(function(_){return true})))(a)))};
var not = function(b){return (function(){var $pm = b;return $pm?((function(){return false})()):((!$pm)?((function(){return true})()):(error("pattern match fail")))})()};
var contains2 = function(x){return function(xs){return function(i){return (function(){var $pm = ($lt(i))(length(xs));return $pm?((function(){return (function(){var $pm = ($eq((get(i))(xs)))(x);return $pm?((function(){return true})()):((!$pm)?((function(){return ((contains2(x))(xs))(($add(i))(1))})()):(error("pattern match fail")))})()})()):((!$pm)?((function(){return false})()):(error("pattern match fail")))})()}}};
var contains = function(x){return function(xs){return ((contains2(x))(xs))(0)}};
var join = function(xs){return function(s){return (function(){var $pm = length(xs);return (0==$pm)?((function(){return ""})()):((function(n){return (foldl1(function(a){return function(b){return ($concat(($concat(a))(s)))(b)}}))(xs)})($pm))})()}};
var zipWithIndex2 = function(n){return function(xs){return (function(){var $pm = length(xs);return (0==$pm)?((function(){return emptyArray})()):((function(x){return (enqueue((Pair(n))((get(0))(xs))))((zipWithIndex2(($add(n))(1)))((slice(1))(xs)))})($pm))})()}};
var zipWithIndex = zipWithIndex2(0);
var concatMap = function(f){return function(a){return ((foldl(concat))(emptyArray))((map(f))(a))}};
var head = get(0);
var tail = slice(1);
var arr1 = function(x){return (push(x))(emptyArray)};
var arr2 = function(x){return function(y){return (push(y))(arr1(x))}};
var arr3 = function(x){return function(y){return function(z){return (push(z))((arr2(x))(y))}}};
var mergeSet = function(xs){return function(ys){return (function(){var $pm = length(xs);return (0==$pm)?((function(){return ys})()):((function(lx){return (function(){var $pm = length(ys);return (0==$pm)?((function(){return xs})()):((function(ly){return (function(){var $pm = ($lt(head(xs)))(head(ys));return $pm?((function(){return (enqueue(head(xs)))((mergeSet(tail(xs)))(ys))})()):((!$pm)?((function(){return (function(){var $pm = ($eq(head(xs)))(head(ys));return $pm?((function(){return (enqueue(head(xs)))((mergeSet(tail(xs)))(tail(ys)))})()):((!$pm)?((function(){return (enqueue(head(ys)))((mergeSet(xs))(tail(ys)))})()):(error("pattern match fail")))})()})()):(error("pattern match fail")))})()})($pm))})()})($pm))})()}};
var exports = {Just:Just,Nothing:Nothing,Pair:Pair,Left:Left,Right:Right,maybe:maybe,fst:fst,snd:snd,either:either,splitEither:splitEither,not:not,contains2:contains2,contains:contains,join:join,zipWithIndex2:zipWithIndex2,zipWithIndex:zipWithIndex,concatMap:concatMap,head:head,tail:tail,arr1:arr1,arr2:arr2,arr3:arr3,mergeSet:mergeSet}
return exports;})();
cache["//compiler/js/ast.jg"] = (function() {var $JSRef = function($0){this.$0=$0;this.$tag="JSRef"};
var JSRef = function($0){return new $JSRef($0)};
JSRef.$tag = "JSRef";
var $JSIndex = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="JSIndex"};
var JSIndex = function($0){return function($1){return new $JSIndex($0,$1)}};
JSIndex.$tag = "JSIndex";
var $JSUnOp = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="JSUnOp"};
var JSUnOp = function($0){return function($1){return new $JSUnOp($0,$1)}};
JSUnOp.$tag = "JSUnOp";
var $JSBinOp = function($0,$1,$2){this.$0=$0;this.$1=$1;this.$2=$2;this.$tag="JSBinOp"};
var JSBinOp = function($0){return function($1){return function($2){return new $JSBinOp($0,$1,$2)}}};
JSBinOp.$tag = "JSBinOp";
var $JSCall = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="JSCall"};
var JSCall = function($0){return function($1){return new $JSCall($0,$1)}};
JSCall.$tag = "JSCall";
var $JSFun = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="JSFun"};
var JSFun = function($0){return function($1){return new $JSFun($0,$1)}};
JSFun.$tag = "JSFun";
var $JSTernary = function($0,$1,$2){this.$0=$0;this.$1=$1;this.$2=$2;this.$tag="JSTernary"};
var JSTernary = function($0){return function($1){return function($2){return new $JSTernary($0,$1,$2)}}};
JSTernary.$tag = "JSTernary";
var $JSNum = function($0){this.$0=$0;this.$tag="JSNum"};
var JSNum = function($0){return new $JSNum($0)};
JSNum.$tag = "JSNum";
var $JSString = function($0){this.$0=$0;this.$tag="JSString"};
var JSString = function($0){return new $JSString($0)};
JSString.$tag = "JSString";
var $JSBool = function($0){this.$0=$0;this.$tag="JSBool"};
var JSBool = function($0){return new $JSBool($0)};
JSBool.$tag = "JSBool";
var $JSObject = function($0){this.$0=$0;this.$tag="JSObject"};
var JSObject = function($0){return new $JSObject($0)};
JSObject.$tag = "JSObject";
var $JSNull = function(){this.$tag="JSNull"};
var JSNull = new $JSNull();
JSNull.$tag = "JSNull";
var $JSUndefined = function(){this.$tag="JSUndefined"};
var JSUndefined = new $JSUndefined();
JSUndefined.$tag = "JSUndefined";
var $JSInstanceOf = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="JSInstanceOf"};
var JSInstanceOf = function($0){return function($1){return new $JSInstanceOf($0,$1)}};
JSInstanceOf.$tag = "JSInstanceOf";
var $JSNew = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="JSNew"};
var JSNew = function($0){return function($1){return new $JSNew($0,$1)}};
JSNew.$tag = "JSNew";
var $JSExpr = function($0){this.$0=$0;this.$tag="JSExpr"};
var JSExpr = function($0){return new $JSExpr($0)};
JSExpr.$tag = "JSExpr";
var $JSReturn = function($0){this.$0=$0;this.$tag="JSReturn"};
var JSReturn = function($0){return new $JSReturn($0)};
JSReturn.$tag = "JSReturn";
var $JSVar = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="JSVar"};
var JSVar = function($0){return function($1){return new $JSVar($0,$1)}};
JSVar.$tag = "JSVar";
var $JSSwitch = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="JSSwitch"};
var JSSwitch = function($0){return function($1){return new $JSSwitch($0,$1)}};
JSSwitch.$tag = "JSSwitch";
var $JSBreak = function(){this.$tag="JSBreak"};
var JSBreak = new $JSBreak();
JSBreak.$tag = "JSBreak";
var $JSAssign = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="JSAssign"};
var JSAssign = function($0){return function($1){return new $JSAssign($0,$1)}};
JSAssign.$tag = "JSAssign";
var exports = {JSRef:JSRef,JSIndex:JSIndex,JSUnOp:JSUnOp,JSBinOp:JSBinOp,JSCall:JSCall,JSFun:JSFun,JSTernary:JSTernary,JSNum:JSNum,JSString:JSString,JSBool:JSBool,JSObject:JSObject,JSNull:JSNull,JSUndefined:JSUndefined,JSInstanceOf:JSInstanceOf,JSNew:JSNew,JSExpr:JSExpr,JSReturn:JSReturn,JSVar:JSVar,JSSwitch:JSSwitch,JSBreak:JSBreak,JSAssign:JSAssign}
return exports;})();
cache["//compiler/parsers.jg"] = (function() {var $concat = (_require("./builtins.js")).$concat;
var emptyArray = (_require("./builtins.js")).emptyArray;
var push = (_require("./builtins.js")).push;
var enqueue = (_require("./builtins.js")).enqueue;
var error = (_require("./builtins.js")).error;
var iterate = (_require("./builtins.js")).iterate;
var True = (_require("./builtins.js")).True;
var False = (_require("./builtins.js")).False;
var Just = (_require("//compiler/prelude.jg")).Just;
var Nothing = (_require("//compiler/prelude.jg")).Nothing;
var Pair = (_require("//compiler/prelude.jg")).Pair;
var Left = (_require("//compiler/prelude.jg")).Left;
var Right = (_require("//compiler/prelude.jg")).Right;
var fst = (_require("//compiler/prelude.jg")).fst;
var snd = (_require("//compiler/prelude.jg")).snd;
var $Success = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="Success"};
var Success = function($0){return function($1){return new $Success($0,$1)}};
Success.$tag = "Success";
var $Error = function($0){this.$0=$0;this.$tag="Error"};
var Error = function($0){return new $Error($0)};
Error.$tag = "Error";
var and = function(a){return function(b){return function(s){return (function(){var $pm = a(s);return ($pm.$tag==Success.$tag)?((function(a,s){return (function(){var $pm = b(s);return ($pm.$tag==Success.$tag)?((function(b,s){return (Success((Pair(a))(b)))(s)})($pm.$0,$pm.$1)):((function(e){return e})($pm))})()})($pm.$0,$pm.$1)):((function(e){return e})($pm))})()}}};
var apply = function(f){return function(p){return function(s){return (function(){var $pm = p(s);return ($pm.$tag==Success.$tag)?((function(r,s){return (Success(f(r)))(s)})($pm.$0,$pm.$1)):((function(e){return e})($pm))})()}}};
var precedes = function(a){return function(b){return (apply(snd))((and(a))(b))}};
var succeeds = function(a){return function(b){return (apply(fst))((and(a))(b))}};
var between = function(a){return function(b){return function(c){return (precedes(a))((succeeds(b))(c))}}};
var or = function(a){return function(b){return function(s){return (function(){var $pm = a(s);return ($pm.$tag==Error.$tag)?((function(e){return b(s)})($pm.$0)):((function(s){return s})($pm))})()}}};
var manyIterate = function(p){return function(s){return ((iterate(Left((Success(emptyArray))(s))))(function(r){return (function(){var $pm = r;return ($pm.$tag==Left.$tag)?((function(s){return false})($pm.$0)):(($pm.$tag==Right.$tag)?((function(s){return true})($pm.$0)):(error("pattern match fail")))})()}))(function(rs){return (function(){var $pm = rs;return (($pm.$tag==Left.$tag)&&($pm.$0.$tag==Success.$tag))?((function(rs,s){return (function(){var $pm = p(s);return ($pm.$tag==Success.$tag)?((function(r,s){return Left((Success((push(r))(rs)))(s))})($pm.$0,$pm.$1)):(($pm.$tag==Error.$tag)?((function(e){return Right((Success(rs))(s))})($pm.$0)):(error("pattern match fail")))})()})($pm.$0.$0,$pm.$0.$1)):(error("pattern match fail"))})()})}};
var many = function(p){return function(s){return (function(){var $pm = (manyIterate(p))(s);return ($pm.$tag==Right.$tag)?((function(a){return a})($pm.$0)):(($pm.$tag==Left.$tag)?((function(b){return error("manyIterate should never return a Left")})($pm.$0)):(error("pattern match fail")))})()}};
var many1 = function(a){return function(s){return (function(){var $pm = a(s);return ($pm.$tag==Success.$tag)?((function(r,s){return ((apply(enqueue(r)))(many(a)))(s)})($pm.$0,$pm.$1)):((function(e){return e})($pm))})()}};
var sepBy1 = function(p){return function(s){return (apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(r,rs){return (enqueue(r))(rs)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((and(p))(many((precedes(s))(p))))}};
var opt = function(a){return function(s){return (function(){var $pm = a(s);return ($pm.$tag==Success.$tag)?((function(r,s){return (Success(Just(r)))(s)})($pm.$0,$pm.$1)):((function(e){return (Success(Nothing))(s)})($pm))})()}};
var digits = "0123456789";
var upperCaseLetters = "ABCDEFGHIJKLMNOPQRSTUVWXYZ";
var letters = ($concat("abcdefghijklmnopqrstuvwxyz"))(upperCaseLetters);
var exports = {Success:Success,Error:Error,and:and,apply:apply,precedes:precedes,succeeds:succeeds,between:between,or:or,manyIterate:manyIterate,many:many,many1:many1,sepBy1:sepBy1,opt:opt,digits:digits,upperCaseLetters:upperCaseLetters,letters:letters}
return exports;})();
cache["//compiler/ast.jg"] = (function() {var concat = (_require("./builtins.js")).concat;
var map = (_require("./builtins.js")).map;
var fst = (_require("//compiler/prelude.jg")).fst;
var concatMap = (_require("//compiler/prelude.jg")).concatMap;
var $Var = function($0){this.$0=$0;this.$tag="Var"};
var Var = function($0){return new $Var($0)};
Var.$tag = "Var";
var $Const = function($0){this.$0=$0;this.$tag="Const"};
var Const = function($0){return new $Const($0)};
Const.$tag = "Const";
var $App = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="App"};
var App = function($0){return function($1){return new $App($0,$1)}};
App.$tag = "App";
var $Lam = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="Lam"};
var Lam = function($0){return function($1){return new $Lam($0,$1)}};
Lam.$tag = "Lam";
var $Case = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="Case"};
var Case = function($0){return function($1){return new $Case($0,$1)}};
Case.$tag = "Case";
var $Let = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="Let"};
var Let = function($0){return function($1){return new $Let($0,$1)}};
Let.$tag = "Let";
var $CNum = function($0){this.$0=$0;this.$tag="CNum"};
var CNum = function($0){return new $CNum($0)};
CNum.$tag = "CNum";
var $CStr = function($0){this.$0=$0;this.$tag="CStr"};
var CStr = function($0){return new $CStr($0)};
CStr.$tag = "CStr";
var $PVar = function($0){this.$0=$0;this.$tag="PVar"};
var PVar = function($0){return new $PVar($0)};
PVar.$tag = "PVar";
var $PConst = function($0){this.$0=$0;this.$tag="PConst"};
var PConst = function($0){return new $PConst($0)};
PConst.$tag = "PConst";
var $PData = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="PData"};
var PData = function($0){return function($1){return new $PData($0,$1)}};
PData.$tag = "PData";
var $Module = function($0,$1,$2){this.$0=$0;this.$1=$1;this.$2=$2;this.$tag="Module"};
var Module = function($0){return function($1){return function($2){return new $Module($0,$1,$2)}}};
Module.$tag = "Module";
var $Data = function($0,$1,$2){this.$0=$0;this.$1=$1;this.$2=$2;this.$tag="Data"};
var Data = function($0){return function($1){return function($2){return new $Data($0,$1,$2)}}};
Data.$tag = "Data";
var $DataCon = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="DataCon"};
var DataCon = function($0){return function($1){return new $DataCon($0,$1)}};
DataCon.$tag = "DataCon";
var $TConst = function($0){this.$0=$0;this.$tag="TConst"};
var TConst = function($0){return new $TConst($0)};
TConst.$tag = "TConst";
var $TVar = function($0){this.$0=$0;this.$tag="TVar"};
var TVar = function($0){return new $TVar($0)};
TVar.$tag = "TVar";
var $TApp = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="TApp"};
var TApp = function($0){return function($1){return new $TApp($0,$1)}};
TApp.$tag = "TApp";
var $TFun = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="TFun"};
var TFun = function($0){return function($1){return new $TFun($0,$1)}};
TFun.$tag = "TFun";
var $ImportClosed = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="ImportClosed"};
var ImportClosed = function($0){return function($1){return new $ImportClosed($0,$1)}};
ImportClosed.$tag = "ImportClosed";
var $ImportOpen = function($0,$1){this.$0=$0;this.$1=$1;this.$tag="ImportOpen"};
var ImportOpen = function($0){return function($1){return new $ImportOpen($0,$1)}};
ImportOpen.$tag = "ImportOpen";
var $ImportAll = function($0){this.$0=$0;this.$tag="ImportAll"};
var ImportAll = function($0){return new $ImportAll($0)};
ImportAll.$tag = "ImportAll";
var dataConName = function(dc){return (function(){var $pm = dc;return ($pm.$tag==DataCon.$tag)?((function(n,ts){return n})($pm.$0,$pm.$1)):(error("pattern match fail"))})()};
var dataConNames = function(d){return (function(){var $pm = d;return ($pm.$tag==Data.$tag)?((function(n,ps,cs){return (map(dataConName))(cs)})($pm.$0,$pm.$1,$pm.$2)):(error("pattern match fail"))})()};
var getExports = function(m){return (function(){var $pm = m;return ($pm.$tag==Module.$tag)?((function(is,ds,vs){return (concat((concatMap(dataConNames))(ds)))((map(fst))(vs))})($pm.$0,$pm.$1,$pm.$2)):(error("pattern match fail"))})()};
var exports = {Var:Var,Const:Const,App:App,Lam:Lam,Case:Case,Let:Let,CNum:CNum,CStr:CStr,PVar:PVar,PConst:PConst,PData:PData,Module:Module,Data:Data,DataCon:DataCon,TConst:TConst,TVar:TVar,TApp:TApp,TFun:TFun,ImportClosed:ImportClosed,ImportOpen:ImportOpen,ImportAll:ImportAll,dataConName:dataConName,dataConNames:dataConNames,getExports:getExports}
return exports;})();
cache["//compiler/js/printer.jg"] = (function() {var $concat = (_require("./builtins.js")).$concat;
var match = (_require("./builtins.js")).match;
var intercalate = (_require("./builtins.js")).intercalate;
var map = (_require("./builtins.js")).map;
var error = (_require("./builtins.js")).error;
var jsonStringify = (_require("./builtins.js")).jsonStringify;
var True = (_require("./builtins.js")).True;
var False = (_require("./builtins.js")).False;
var Pair = (_require("//compiler/prelude.jg")).Pair;
var JSRef = (_require("//compiler/js/ast.jg")).JSRef;
var JSIndex = (_require("//compiler/js/ast.jg")).JSIndex;
var JSUnOp = (_require("//compiler/js/ast.jg")).JSUnOp;
var JSBinOp = (_require("//compiler/js/ast.jg")).JSBinOp;
var JSCall = (_require("//compiler/js/ast.jg")).JSCall;
var JSFun = (_require("//compiler/js/ast.jg")).JSFun;
var JSTernary = (_require("//compiler/js/ast.jg")).JSTernary;
var JSNum = (_require("//compiler/js/ast.jg")).JSNum;
var JSString = (_require("//compiler/js/ast.jg")).JSString;
var JSBool = (_require("//compiler/js/ast.jg")).JSBool;
var JSObject = (_require("//compiler/js/ast.jg")).JSObject;
var JSNull = (_require("//compiler/js/ast.jg")).JSNull;
var JSUndefined = (_require("//compiler/js/ast.jg")).JSUndefined;
var JSInstanceOf = (_require("//compiler/js/ast.jg")).JSInstanceOf;
var JSNew = (_require("//compiler/js/ast.jg")).JSNew;
var JSExpr = (_require("//compiler/js/ast.jg")).JSExpr;
var JSReturn = (_require("//compiler/js/ast.jg")).JSReturn;
var JSVar = (_require("//compiler/js/ast.jg")).JSVar;
var JSSwitch = (_require("//compiler/js/ast.jg")).JSSwitch;
var JSBreak = (_require("//compiler/js/ast.jg")).JSBreak;
var JSAssign = (_require("//compiler/js/ast.jg")).JSAssign;
var jsExprToString = function(e){return (function(){var $pm = e;return ($pm.$tag==JSNull.$tag)?((function(){return "null"})()):(($pm.$tag==JSUndefined.$tag)?((function(){return "undefined"})()):((($pm.$tag==JSBool.$tag)&&$pm.$0)?((function(){return "true"})()):((($pm.$tag==JSBool.$tag)&&(!$pm.$0))?((function(){return "false"})()):(($pm.$tag==JSNum.$tag)?((function(n){return jsonStringify(n)})($pm.$0)):(($pm.$tag==JSString.$tag)?((function(s){return jsonStringify(s)})($pm.$0)):((($pm.$tag==JSRef.$tag)&&("+"==$pm.$0))?((function(){return "$add"})()):((($pm.$tag==JSRef.$tag)&&("-"==$pm.$0))?((function(){return "$del"})()):((($pm.$tag==JSRef.$tag)&&("*"==$pm.$0))?((function(){return "$mul"})()):((($pm.$tag==JSRef.$tag)&&("<"==$pm.$0))?((function(){return "$lt"})()):((($pm.$tag==JSRef.$tag)&&(">"==$pm.$0))?((function(){return "$gt"})()):((($pm.$tag==JSRef.$tag)&&("=="==$pm.$0))?((function(){return "$eq"})()):((($pm.$tag==JSRef.$tag)&&("/="==$pm.$0))?((function(){return "$neq"})()):((($pm.$tag==JSRef.$tag)&&("&&"==$pm.$0))?((function(){return "$and"})()):((($pm.$tag==JSRef.$tag)&&("||"==$pm.$0))?((function(){return "$or"})()):((($pm.$tag==JSRef.$tag)&&("++"==$pm.$0))?((function(){return "$concat"})()):(($pm.$tag==JSRef.$tag)?((function(v){return v})($pm.$0)):((($pm.$tag==JSIndex.$tag)&&($pm.$1.$tag==JSString.$tag))?((function(xs,i){return (function(){var $pm = (match("^[a-zA-Z_$][a-zA-Z0-9_$]*$"))(i);return (""==$pm)?((function(){return ($concat(($concat(($concat(jsExprToParenString(xs)))("[")))(jsExprToString(i))))("]")})()):((function(i){return ($concat(($concat(jsExprToParenString(xs)))(".")))(i)})($pm))})()})($pm.$0,$pm.$1.$0)):(($pm.$tag==JSIndex.$tag)?((function(xs,i){return ($concat(($concat(($concat(jsExprToParenString(xs)))("[")))(jsExprToString(i))))("]")})($pm.$0,$pm.$1)):(($pm.$tag==JSUnOp.$tag)?((function(op,e){return ($concat(op))(jsExprToParenString(e))})($pm.$0,$pm.$1)):(($pm.$tag==JSBinOp.$tag)?((function(op,a,b){return ($concat(($concat(jsExprToParenString(a)))(op)))(jsExprToParenString(b))})($pm.$0,$pm.$1,$pm.$2)):(($pm.$tag==JSCall.$tag)?((function(f,xs){return ($concat(jsExprToParenString(f)))(paren((intercalate(","))((map(jsExprToString))(xs))))})($pm.$0,$pm.$1)):(($pm.$tag==JSNew.$tag)?((function(c,xs){return ($concat(($concat("new "))(jsExprToParenString(c))))(paren((intercalate(","))((map(jsExprToString))(xs))))})($pm.$0,$pm.$1)):(($pm.$tag==JSFun.$tag)?((function(ps,bs){return ($concat(($concat(($concat(($concat("function("))((intercalate(","))(ps))))("){")))((intercalate(";"))((map(jsStmtToString))(bs)))))("}")})($pm.$0,$pm.$1)):(($pm.$tag==JSTernary.$tag)?((function(b,x,y){return ($concat(($concat(($concat(($concat(jsExprToParenString(b)))("?")))(jsExprToParenString(x))))(":")))(jsExprToParenString(y))})($pm.$0,$pm.$1,$pm.$2)):(($pm.$tag==JSObject.$tag)?((function(kvs){return ($concat(($concat("{"))((intercalate(","))((map(keyValueToString))(kvs)))))("}")})($pm.$0)):(($pm.$tag==JSInstanceOf.$tag)?((function(x,c){return ($concat(($concat(jsExprToParenString(x)))(" instanceof ")))(jsExprToParenString(c))})($pm.$0,$pm.$1)):((function(e){return error(e)})($pm))))))))))))))))))))))))))))})()};
var jsExprToParenString = function(e){return (function(){var $pm = e;return ($pm.$tag==JSRef.$tag)?((function(r){return jsExprToString(e)})($pm.$0)):(($pm.$tag==JSNum.$tag)?((function(n){return jsExprToString(e)})($pm.$0)):(($pm.$tag==JSString.$tag)?((function(s){return jsExprToString(e)})($pm.$0)):(($pm.$tag==JSBool.$tag)?((function(b){return jsExprToString(e)})($pm.$0)):(($pm.$tag==JSIndex.$tag)?((function(xs,i){return jsExprToString(e)})($pm.$0,$pm.$1)):(($pm.$tag==JSNew.$tag)?((function(c,xs){return jsExprToString(e)})($pm.$0,$pm.$1)):(($pm.$tag==JSObject.$tag)?((function(kvs){return jsExprToString(e)})($pm.$0)):((function(e){return paren(jsExprToString(e))})($pm))))))))})()};
var keyValueToString = function(kv){return (function(){var $pm = kv;return ($pm.$tag==Pair.$tag)?((function(k,v){return ($concat(($concat(k))(":")))(jsExprToString(v))})($pm.$0,$pm.$1)):(error("pattern match fail"))})()};
var jsStmtToString = function(s){return (function(){var $pm = s;return ($pm.$tag==JSExpr.$tag)?((function(e){return jsExprToString(e)})($pm.$0)):(($pm.$tag==JSReturn.$tag)?((function(e){return ($concat("return "))(jsExprToString(e))})($pm.$0)):(($pm.$tag==JSVar.$tag)?((function(v,e){return ($concat(($concat(($concat("var "))(v)))(" = ")))(jsExprToString(e))})($pm.$0,$pm.$1)):(($pm.$tag==JSBreak.$tag)?((function(){return "break"})()):(($pm.$tag==JSSwitch.$tag)?((function(e,cs){return ($concat(($concat(($concat(($concat("switch"))(paren(jsExprToString(e)))))("{")))((intercalate(";\n"))((map(caseToString))(cs)))))("}")})($pm.$0,$pm.$1)):(($pm.$tag==JSAssign.$tag)?((function(l,r){return ($concat(($concat(jsExprToParenString(l)))(" = ")))(jsExprToParenString(r))})($pm.$0,$pm.$1)):(error("pattern match fail")))))))})()};
var caseToString = function(c){return (function(){var $pm = c;return ($pm.$tag==Pair.$tag)?((function(m,ss){return ($concat(($concat(($concat("case "))(paren(jsExprToString(m)))))(":\n  ")))((intercalate(";"))((map(jsStmtToString))(ss)))})($pm.$0,$pm.$1)):(error("pattern match fail"))})()};
var paren = function(s){return ($concat(($concat("("))(s)))(")")};
var exports = {jsExprToString:jsExprToString,jsExprToParenString:jsExprToParenString,keyValueToString:keyValueToString,jsStmtToString:jsStmtToString,caseToString:caseToString,paren:paren}
return exports;})();
cache["//compiler/js/deadCode.jg"] = (function() {var map = (_require("./builtins.js")).map;
var True = (_require("./builtins.js")).True;
var False = (_require("./builtins.js")).False;
var Pair = (_require("//compiler/prelude.jg")).Pair;
var JSIndex = (_require("//compiler/js/ast.jg")).JSIndex;
var JSBinOp = (_require("//compiler/js/ast.jg")).JSBinOp;
var JSCall = (_require("//compiler/js/ast.jg")).JSCall;
var JSFun = (_require("//compiler/js/ast.jg")).JSFun;
var JSTernary = (_require("//compiler/js/ast.jg")).JSTernary;
var JSBool = (_require("//compiler/js/ast.jg")).JSBool;
var JSObject = (_require("//compiler/js/ast.jg")).JSObject;
var JSInstanceOf = (_require("//compiler/js/ast.jg")).JSInstanceOf;
var JSNew = (_require("//compiler/js/ast.jg")).JSNew;
var JSExpr = (_require("//compiler/js/ast.jg")).JSExpr;
var JSReturn = (_require("//compiler/js/ast.jg")).JSReturn;
var JSVar = (_require("//compiler/js/ast.jg")).JSVar;
var tryDCE = function(e){return (function(){var $pm = e;return ((($pm.$tag==JSBinOp.$tag)&&("&&"==$pm.$0))&&(($pm.$1.$tag==JSBool.$tag)&&$pm.$1.$0))?((function(e){return e})($pm.$2)):(((($pm.$tag==JSBinOp.$tag)&&("&&"==$pm.$0))&&(($pm.$2.$tag==JSBool.$tag)&&$pm.$2.$0))?((function(e){return e})($pm.$1)):((($pm.$tag==JSTernary.$tag)&&(($pm.$0.$tag==JSBool.$tag)&&$pm.$0.$0))?((function(a,b){return a})($pm.$1,$pm.$2)):((($pm.$tag==JSTernary.$tag)&&(($pm.$0.$tag==JSBool.$tag)&&(!$pm.$0.$0)))?((function(a,b){return b})($pm.$1,$pm.$2)):((function(e){return e})($pm)))))})()};
var rewriteDCE = function(e){return (function(){var $pm = e;return ($pm.$tag==JSIndex.$tag)?((function(xs,i){return (JSIndex(rewriteDCE(xs)))(rewriteDCE(i))})($pm.$0,$pm.$1)):(($pm.$tag==JSBinOp.$tag)?((function(op,a,b){return tryDCE(((JSBinOp(op))(rewriteDCE(a)))(rewriteDCE(b)))})($pm.$0,$pm.$1,$pm.$2)):(($pm.$tag==JSCall.$tag)?((function(f,xs){return (JSCall(rewriteDCE(f)))((map(rewriteDCE))(xs))})($pm.$0,$pm.$1)):(($pm.$tag==JSFun.$tag)?((function(ps,bs){return (JSFun(ps))((map(rewriteStmt))(bs))})($pm.$0,$pm.$1)):(($pm.$tag==JSTernary.$tag)?((function(b,x,y){return tryDCE(((JSTernary(rewriteDCE(b)))(rewriteDCE(x)))(rewriteDCE(y)))})($pm.$0,$pm.$1,$pm.$2)):(($pm.$tag==JSObject.$tag)?((function(kvs){return JSObject((map(function(kv){return (function(){var $pm = kv;return ($pm.$tag==Pair.$tag)?((function(k,v){return (Pair(k))(rewriteDCE(v))})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))(kvs))})($pm.$0)):(($pm.$tag==JSInstanceOf.$tag)?((function(x,c){return (JSInstanceOf(rewriteDCE(x)))(rewriteDCE(c))})($pm.$0,$pm.$1)):(($pm.$tag==JSNew.$tag)?((function(c,xs){return (JSNew(rewriteDCE(c)))((map(rewriteDCE))(xs))})($pm.$0,$pm.$1)):((function(e){return e})($pm)))))))))})()};
var rewriteStmt = function(s){return (function(){var $pm = s;return ($pm.$tag==JSExpr.$tag)?((function(e){return JSExpr(rewriteDCE(e))})($pm.$0)):(($pm.$tag==JSReturn.$tag)?((function(e){return JSReturn(rewriteDCE(e))})($pm.$0)):(($pm.$tag==JSVar.$tag)?((function(n,v){return (JSVar(n))(rewriteDCE(v))})($pm.$0,$pm.$1)):(($pm.$tag==JSExpr.$tag)?((function(l,r){return (JSExpr(rewriteDCE(l)))(rewriteDCE(r))})($pm.$0,$pm.$1)):((function(s){return s})($pm)))))})()};
var exports = {tryDCE:tryDCE,rewriteDCE:rewriteDCE,rewriteStmt:rewriteStmt}
return exports;})();
cache["//compiler/jaguarLexer.jg"] = (function() {var $add = (_require("./builtins.js")).$add;
var $concat = (_require("./builtins.js")).$concat;
var get = (_require("./builtins.js")).get;
var foldl = (_require("./builtins.js")).foldl;
var True = (_require("./builtins.js")).True;
var False = (_require("./builtins.js")).False;
var Pair = (_require("//compiler/prelude.jg")).Pair;
var maybe = (_require("//compiler/prelude.jg")).maybe;
var not = (_require("//compiler/prelude.jg")).not;
var contains = (_require("//compiler/prelude.jg")).contains;
var Success = (_require("//compiler/parsers.jg")).Success;
var Error = (_require("//compiler/parsers.jg")).Error;
var and = (_require("//compiler/parsers.jg")).and;
var apply = (_require("//compiler/parsers.jg")).apply;
var precedes = (_require("//compiler/parsers.jg")).precedes;
var between = (_require("//compiler/parsers.jg")).between;
var or = (_require("//compiler/parsers.jg")).or;
var many = (_require("//compiler/parsers.jg")).many;
var many1 = (_require("//compiler/parsers.jg")).many1;
var opt = (_require("//compiler/parsers.jg")).opt;
var digits = (_require("//compiler/parsers.jg")).digits;
var letters = (_require("//compiler/parsers.jg")).letters;
var $LexerState = function($0,$1,$2,$3){this.$0=$0;this.$1=$1;this.$2=$2;this.$3=$3;this.$tag="LexerState"};
var LexerState = function($0){return function($1){return function($2){return function($3){return new $LexerState($0,$1,$2,$3)}}}};
LexerState.$tag = "LexerState";
var $WsTok = function(){this.$tag="WsTok"};
var WsTok = new $WsTok();
WsTok.$tag = "WsTok";
var $SymTok = function(){this.$tag="SymTok"};
var SymTok = new $SymTok();
SymTok.$tag = "SymTok";
var $NumTok = function(){this.$tag="NumTok"};
var NumTok = new $NumTok();
NumTok.$tag = "NumTok";
var $StrTok = function(){this.$tag="StrTok"};
var StrTok = new $StrTok();
StrTok.$tag = "StrTok";
var $OpTok = function(){this.$tag="OpTok"};
var OpTok = new $OpTok();
OpTok.$tag = "OpTok";
var $IdTok = function(){this.$tag="IdTok"};
var IdTok = new $IdTok();
IdTok.$tag = "IdTok";
var $ComTok = function(){this.$tag="ComTok"};
var ComTok = new $ComTok();
ComTok.$tag = "ComTok";
var $Token = function($0,$1,$2,$3){this.$0=$0;this.$1=$1;this.$2=$2;this.$3=$3;this.$tag="Token"};
var Token = function($0){return function($1){return function($2){return function($3){return new $Token($0,$1,$2,$3)}}}};
Token.$tag = "Token";
var mkTok = function(t){return function(p){return function(i){return (function(){var $pm = i;return ($pm.$tag==LexerState.$tag)?((function(_1,_2,l,c){return ((apply(function(r){return (((Token(t))(r))(l))(c)}))(p))(i)})($pm.$0,$pm.$1,$pm.$2,$pm.$3)):(error("pattern match fail"))})()}}};
var concatStr = apply((foldl(function(cs){return function(c){return ($concat(cs))(c)}}))(""));
var runLexer = function(p){return function(s){return p((((LexerState(s))(0))(0))(0))}};
var parseChar = function(p){return function(s){return (function(){var $pm = s;return ($pm.$tag==LexerState.$tag)?((function(s,i,l,c){return (function(){var $pm = p((get(i))(s));return (!$pm)?((function(){return Error("parser failed")})()):($pm?((function(){return (function(){var $pm = (get(i))(s);return ("\n"==$pm)?((function(){return (Success((get(i))(s)))((((LexerState(s))(($add(i))(1)))(($add(l))(1)))(0))})()):((function(x){return (Success((get(i))(s)))((((LexerState(s))(($add(i))(1)))(l))(($add(c))(1)))})($pm))})()})()):(error("pattern match fail")))})()})($pm.$0,$pm.$1,$pm.$2,$pm.$3)):(error("pattern match fail"))})()}};
var anyCharP = parseChar(function(c){return true});
var charP = function(cs){return parseChar(function(c){return (contains(c))(cs)})};
var notCharP = function(cs){return parseChar(function(c){return not((contains(c))(cs))})};
var stringCharP = (or((apply(function(c){return "\n"}))((and(charP("\\")))(charP("n")))))((or((precedes(charP("\\")))(anyCharP)))(notCharP("'")));
var stringP = (mkTok(StrTok))(concatStr(((between(charP("'")))(many(stringCharP)))(charP("'"))));
var whitespaceP = (mkTok(WsTok))(concatStr(many1(charP(" \n"))));
var intP = concatStr(many1(charP(digits)));
var numP = (mkTok(NumTok))((apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(a,b){return ($concat(a))(b)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((and(intP))((apply((maybe(function(n){return ($concat("."))(n)}))("")))(opt((precedes(charP(".")))(intP))))));
var lineCommentP = (mkTok(ComTok))(concatStr((precedes((and(charP("/")))(charP("/"))))(many(notCharP("\n")))));
var symbolP = (mkTok(SymTok))(charP("()[]{},\\"));
var identP = (mkTok(IdTok))((apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(a,b){return ($concat(a))(b)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((and(charP(($concat(letters))("_"))))(concatStr(many(charP(($concat(($concat(letters))(digits)))("_")))))));
var opP = (mkTok(OpTok))(concatStr(many1(charP("-+*/=:&|<>^"))));
var jaguarTokenP = many((or(stringP))((or(whitespaceP))((or(numP))((or(lineCommentP))((or(identP))((or(opP))(symbolP)))))));
var tokenize = runLexer(jaguarTokenP);
var exports = {LexerState:LexerState,WsTok:WsTok,SymTok:SymTok,NumTok:NumTok,StrTok:StrTok,OpTok:OpTok,IdTok:IdTok,ComTok:ComTok,Token:Token,mkTok:mkTok,concatStr:concatStr,runLexer:runLexer,parseChar:parseChar,anyCharP:anyCharP,charP:charP,notCharP:notCharP,stringCharP:stringCharP,stringP:stringP,whitespaceP:whitespaceP,intP:intP,numP:numP,lineCommentP:lineCommentP,symbolP:symbolP,identP:identP,opP:opP,jaguarTokenP:jaguarTokenP,tokenize:tokenize}
return exports;})();
cache["//compiler/js/jaguarToJs.jg"] = (function() {var $add = (_require("./builtins.js")).$add;
var $neq = (_require("./builtins.js")).$neq;
var $concat = (_require("./builtins.js")).$concat;
var get = (_require("./builtins.js")).get;
var emptyArray = (_require("./builtins.js")).emptyArray;
var push = (_require("./builtins.js")).push;
var enqueue = (_require("./builtins.js")).enqueue;
var intToString = (_require("./builtins.js")).intToString;
var concat = (_require("./builtins.js")).concat;
var map = (_require("./builtins.js")).map;
var filter = (_require("./builtins.js")).filter;
var foldr = (_require("./builtins.js")).foldr;
var foldl = (_require("./builtins.js")).foldl;
var error = (_require("./builtins.js")).error;
var True = (_require("./builtins.js")).True;
var False = (_require("./builtins.js")).False;
var Pair = (_require("//compiler/prelude.jg")).Pair;
var fst = (_require("//compiler/prelude.jg")).fst;
var snd = (_require("//compiler/prelude.jg")).snd;
var not = (_require("//compiler/prelude.jg")).not;
var contains = (_require("//compiler/prelude.jg")).contains;
var zipWithIndex = (_require("//compiler/prelude.jg")).zipWithIndex;
var concatMap = (_require("//compiler/prelude.jg")).concatMap;
var arr1 = (_require("//compiler/prelude.jg")).arr1;
var arr2 = (_require("//compiler/prelude.jg")).arr2;
var arr3 = (_require("//compiler/prelude.jg")).arr3;
var mergeSet = (_require("//compiler/prelude.jg")).mergeSet;
var Var = (_require("//compiler/ast.jg")).Var;
var Const = (_require("//compiler/ast.jg")).Const;
var App = (_require("//compiler/ast.jg")).App;
var Lam = (_require("//compiler/ast.jg")).Lam;
var Case = (_require("//compiler/ast.jg")).Case;
var Let = (_require("//compiler/ast.jg")).Let;
var CNum = (_require("//compiler/ast.jg")).CNum;
var CStr = (_require("//compiler/ast.jg")).CStr;
var PVar = (_require("//compiler/ast.jg")).PVar;
var PConst = (_require("//compiler/ast.jg")).PConst;
var PData = (_require("//compiler/ast.jg")).PData;
var Module = (_require("//compiler/ast.jg")).Module;
var Data = (_require("//compiler/ast.jg")).Data;
var DataCon = (_require("//compiler/ast.jg")).DataCon;
var ImportClosed = (_require("//compiler/ast.jg")).ImportClosed;
var ImportOpen = (_require("//compiler/ast.jg")).ImportOpen;
var ImportAll = (_require("//compiler/ast.jg")).ImportAll;
var getExports = (_require("//compiler/ast.jg")).getExports;
var JSRef = (_require("//compiler/js/ast.jg")).JSRef;
var JSIndex = (_require("//compiler/js/ast.jg")).JSIndex;
var JSUnOp = (_require("//compiler/js/ast.jg")).JSUnOp;
var JSBinOp = (_require("//compiler/js/ast.jg")).JSBinOp;
var JSCall = (_require("//compiler/js/ast.jg")).JSCall;
var JSFun = (_require("//compiler/js/ast.jg")).JSFun;
var JSTernary = (_require("//compiler/js/ast.jg")).JSTernary;
var JSNum = (_require("//compiler/js/ast.jg")).JSNum;
var JSString = (_require("//compiler/js/ast.jg")).JSString;
var JSBool = (_require("//compiler/js/ast.jg")).JSBool;
var JSObject = (_require("//compiler/js/ast.jg")).JSObject;
var JSNew = (_require("//compiler/js/ast.jg")).JSNew;
var JSExpr = (_require("//compiler/js/ast.jg")).JSExpr;
var JSReturn = (_require("//compiler/js/ast.jg")).JSReturn;
var JSVar = (_require("//compiler/js/ast.jg")).JSVar;
var JSAssign = (_require("//compiler/js/ast.jg")).JSAssign;
var jaguarExprToJsExpr = function(e){return (function(){var $pm = e;return (($pm.$tag==Var.$tag)&&("True"==$pm.$0))?((function(){return JSBool(true)})()):((($pm.$tag==Var.$tag)&&("False"==$pm.$0))?((function(){return JSBool(false)})()):(($pm.$tag==Var.$tag)?((function(v){return JSRef(v)})($pm.$0)):((($pm.$tag==Const.$tag)&&($pm.$0.$tag==CNum.$tag))?((function(n){return JSNum(n)})($pm.$0.$0)):((($pm.$tag==Const.$tag)&&($pm.$0.$tag==CStr.$tag))?((function(s){return JSString(s)})($pm.$0.$0)):(($pm.$tag==App.$tag)?((function(f,a){return (JSCall(jaguarExprToJsExpr(f)))(arr1(jaguarExprToJsExpr(a)))})($pm.$0,$pm.$1)):(($pm.$tag==Lam.$tag)?((function(p,e){return (JSFun(arr1(p)))(arr1(JSReturn(jaguarExprToJsExpr(e))))})($pm.$0,$pm.$1)):(($pm.$tag==Case.$tag)?((function(e,ps){return (JSCall((JSFun(emptyArray))((arr2((JSVar("$pm"))(jaguarExprToJsExpr(e))))(JSReturn(((foldr(assemblePatternMatch))((JSCall(JSRef("error")))(arr1(JSString("pattern match fail")))))(ps))))))(emptyArray)})($pm.$0,$pm.$1)):(($pm.$tag==Let.$tag)?((function(ds,e){return (JSCall((JSFun(emptyArray))((push(JSReturn(jaguarExprToJsExpr(e))))((map(defToJs))(ds)))))(emptyArray)})($pm.$0,$pm.$1)):(error("pattern match fail"))))))))))})()};
var assemblePatternMatch = function(alt){return function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(pat,e){return (function(){var $pm = (processPattern(JSRef("$pm")))(pat);return (($pm.$tag==Pair.$tag)&&($pm.$1.$tag==Pair.$tag))?((function(f,ns,vs){return ((JSTernary(f))((JSCall((JSFun(ns))(arr1(JSReturn(jaguarExprToJsExpr(e))))))(vs)))(alt)})($pm.$0,$pm.$1.$0,$pm.$1.$1)):(error("pattern match fail"))})()})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}};
var processPattern = function(pm){return function(p){return (function(){var $pm = p;return ($pm.$tag==PVar.$tag)?((function(v){return (Pair(JSBool(true)))((Pair(arr1(v)))(arr1(pm)))})($pm.$0)):((($pm.$tag==PConst.$tag)&&($pm.$0.$tag==CNum.$tag))?((function(n){return (Pair(((JSBinOp("=="))(JSNum(n)))(pm)))((Pair(emptyArray))(emptyArray))})($pm.$0.$0)):((($pm.$tag==PConst.$tag)&&($pm.$0.$tag==CStr.$tag))?((function(s){return (Pair(((JSBinOp("=="))(JSString(s)))(pm)))((Pair(emptyArray))(emptyArray))})($pm.$0.$0)):((($pm.$tag==PData.$tag)&&("True"==$pm.$0))?((function(ps){return (Pair(pm))((Pair(emptyArray))(emptyArray))})($pm.$1)):((($pm.$tag==PData.$tag)&&("False"==$pm.$0))?((function(ps){return (Pair((JSUnOp("!"))(pm)))((Pair(emptyArray))(emptyArray))})($pm.$1)):(($pm.$tag==PData.$tag)?((function(t,ps){return ((foldl(function(a){return function(b){return (function(){var $pm = a;return (($pm.$tag==Pair.$tag)&&($pm.$1.$tag==Pair.$tag))?((function(fa,na,va){return (function(){var $pm = b;return (($pm.$tag==Pair.$tag)&&($pm.$1.$tag==Pair.$tag))?((function(fb,nb,vb){return (Pair(((JSBinOp("&&"))(fa))(fb)))((Pair((concat(na))(nb)))((concat(va))(vb)))})($pm.$0,$pm.$1.$0,$pm.$1.$1)):(error("pattern match fail"))})()})($pm.$0,$pm.$1.$0,$pm.$1.$1)):(error("pattern match fail"))})()}}))((Pair(((JSBinOp("=="))((JSIndex(pm))(JSString("$tag"))))((JSIndex(JSRef(t)))(JSString("$tag")))))((Pair(emptyArray))(emptyArray))))((map(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(n,pat){return (processPattern((JSIndex(pm))(JSString(($concat("$"))(intToString(n))))))(pat)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))(zipWithIndex(ps)))})($pm.$0,$pm.$1)):((function(z){return error("failure to match pattern during processing")})($pm)))))))})()}};
var defToJs = function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(n,e){return (JSVar(n))(jaguarExprToJsExpr(e))})($pm.$0,$pm.$1)):(error("pattern match fail"))})()};
var requireExpr = function(f){return (JSCall(JSRef("_require")))(arr1(JSString(f)))};
var buildImports = function(f){return function(ns){return (map(function(n){return (JSVar(n))((JSIndex(requireExpr(f)))(JSString(n)))}))(ns)}};
var importToJs = function(importSymbols){return function(freeVars){return function(i){return (function(){var $pm = i;return ($pm.$tag==ImportClosed.$tag)?((function(f,n){return (function(){var $pm = (contains(n))(freeVars);return $pm?((function(){return arr1((JSVar(n))(requireExpr(f)))})()):((!$pm)?((function(){return emptyArray})()):(error("pattern match fail")))})()})($pm.$0,$pm.$1)):(($pm.$tag==ImportOpen.$tag)?((function(f,ns){return (buildImports(f))((filter(function(n){return (contains(n))(freeVars)}))(ns))})($pm.$0,$pm.$1)):(($pm.$tag==ImportAll.$tag)?((function(f){return (buildImports(f))((filter(function(n){return (contains(n))(freeVars)}))((get(f))(importSymbols)))})($pm.$0)):(error("pattern match fail"))))})()}}};
var dataConFieldIds = function(ts){return (map(function(p){return ($concat("$"))(intToString(fst(p)))}))(zipWithIndex(ts))};
var dataConToJs = function(dc){return (function(){var $pm = dc;return ($pm.$tag==DataCon.$tag)?((function(n,ts){return ((arr3((JSVar(($add("$"))(n)))((JSFun(dataConFieldIds(ts)))((push(JSExpr(((JSBinOp("="))((JSIndex(JSRef("this")))(JSString("$tag"))))(JSString(n)))))((map(function(f){return JSExpr(((JSBinOp("="))((JSIndex(JSRef("this")))(JSString(f))))(JSRef(f)))}))(dataConFieldIds(ts)))))))((JSVar(n))(((foldr(function(b){return function(f){return (JSFun(arr1(f)))(arr1(JSReturn(b)))}}))((JSNew(JSRef(($add("$"))(n))))((map(JSRef))(dataConFieldIds(ts)))))(dataConFieldIds(ts)))))((JSAssign((JSIndex(JSRef(n)))(JSString("$tag"))))(JSString(n)))})($pm.$0,$pm.$1)):(error("pattern match fail"))})()};
var dataToJs = function(d){return (function(){var $pm = d;return ($pm.$tag==Data.$tag)?((function(n,ps,cs){return (concatMap(dataConToJs))(cs)})($pm.$0,$pm.$1,$pm.$2)):(error("pattern match fail"))})()};
var exportObject = function(m){return JSObject((map(function(n){return (Pair(n))(JSRef(n))}))(getExports(m)))};
var moduleToJs = function(importSymbols){return function(m){return (push((JSVar("exports"))(exportObject(m))))((function(){var $pm = m;return ($pm.$tag==Module.$tag)?((function(is,ds,vs){return (concat((concatMap((importToJs(importSymbols))(freeVarsInModule(m))))((enqueue(ImportAll("./builtins.js")))(is))))((concat((concatMap(dataToJs))(ds)))((map(defToJs))(vs)))})($pm.$0,$pm.$1,$pm.$2)):(error("pattern match fail"))})())}};
var opName = function(op){return (function(){var $pm = op;return ("+"==$pm)?((function(){return "$add"})()):(("-"==$pm)?((function(){return "$del"})()):(("*"==$pm)?((function(){return "$mul"})()):(("<"==$pm)?((function(){return "$lt"})()):((">"==$pm)?((function(){return "$gt"})()):(("=="==$pm)?((function(){return "$eq"})()):(("/="==$pm)?((function(){return "$neq"})()):(("&&"==$pm)?((function(){return "$and"})()):(("||"==$pm)?((function(){return "$or"})()):(("++"==$pm)?((function(){return "$concat"})()):((function(nonOp){return nonOp})($pm)))))))))))})()};
var freeVarsInModule = function(m){return (function(){var $pm = m;return ($pm.$tag==Module.$tag)?((function(is,ds,vs){return (map(opName))(((foldl(mergeSet))(emptyArray))((map(function(p){return freeVarsInExpr(snd(p))}))(vs)))})($pm.$0,$pm.$1,$pm.$2)):(error("pattern match fail"))})()};
var freeVarsInExpr = function(e){return (function(){var $pm = e;return ($pm.$tag==Var.$tag)?((function(v){return arr1(v)})($pm.$0)):(($pm.$tag==Const.$tag)?((function(c){return emptyArray})($pm.$0)):(($pm.$tag==App.$tag)?((function(f,x){return (mergeSet(freeVarsInExpr(f)))(freeVarsInExpr(x))})($pm.$0,$pm.$1)):(($pm.$tag==Lam.$tag)?((function(p,b){return (filter(function(v){return ($neq(v))(p)}))(freeVarsInExpr(b))})($pm.$0,$pm.$1)):(($pm.$tag==Case.$tag)?((function(e,ps){return ((foldl(mergeSet))(freeVarsInExpr(e)))((map(freeVarsInPat))(ps))})($pm.$0,$pm.$1)):(($pm.$tag==Let.$tag)?((function(ds,e){return (filter(function(v){return not((contains(v))((map(fst))(ds)))}))(((foldl(mergeSet))(freeVarsInExpr(e)))((map(function(d){return freeVarsInExpr(snd(d))}))(ds)))})($pm.$0,$pm.$1)):(error("pattern match fail")))))))})()};
var freeVarsInPat = function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(pat,e){return (mergeSet((filter(function(v){return not((contains(v))(namesInPat(pat)))}))(freeVarsInExpr(e))))(freeVarsInPData(pat))})($pm.$0,$pm.$1)):(error("pattern match fail"))})()};
var freeVarsInPData = function(p){return (function(){var $pm = p;return ($pm.$tag==PData.$tag)?((function(n,ps){return ((foldl(mergeSet))(arr1(n)))((map(freeVarsInPData))(ps))})($pm.$0,$pm.$1)):((function(p){return emptyArray})($pm))})()};
var namesInPat = function(p){return (function(){var $pm = p;return ($pm.$tag==PVar.$tag)?((function(v){return arr1(v)})($pm.$0)):(($pm.$tag==PConst.$tag)?((function(c){return emptyArray})($pm.$0)):(($pm.$tag==PData.$tag)?((function(n,ps){return ((foldl(mergeSet))(emptyArray))((map(namesInPat))(ps))})($pm.$0,$pm.$1)):(error("pattern match fail"))))})()};
var exports = {jaguarExprToJsExpr:jaguarExprToJsExpr,assemblePatternMatch:assemblePatternMatch,processPattern:processPattern,defToJs:defToJs,requireExpr:requireExpr,buildImports:buildImports,importToJs:importToJs,dataConFieldIds:dataConFieldIds,dataConToJs:dataConToJs,dataToJs:dataToJs,exportObject:exportObject,moduleToJs:moduleToJs,opName:opName,freeVarsInModule:freeVarsInModule,freeVarsInExpr:freeVarsInExpr,freeVarsInPat:freeVarsInPat,freeVarsInPData:freeVarsInPData,namesInPat:namesInPat}
return exports;})();
cache["//compiler/jaguarParser.jg"] = (function() {var $add = (_require("./builtins.js")).$add;
var $lt = (_require("./builtins.js")).$lt;
var $gt = (_require("./builtins.js")).$gt;
var $eq = (_require("./builtins.js")).$eq;
var get = (_require("./builtins.js")).get;
var unsafeStringToInt = (_require("./builtins.js")).unsafeStringToInt;
var length = (_require("./builtins.js")).length;
var emptyArray = (_require("./builtins.js")).emptyArray;
var push = (_require("./builtins.js")).push;
var enqueue = (_require("./builtins.js")).enqueue;
var filter = (_require("./builtins.js")).filter;
var foldr = (_require("./builtins.js")).foldr;
var foldr1 = (_require("./builtins.js")).foldr1;
var foldl = (_require("./builtins.js")).foldl;
var True = (_require("./builtins.js")).True;
var False = (_require("./builtins.js")).False;
var Just = (_require("//compiler/prelude.jg")).Just;
var Nothing = (_require("//compiler/prelude.jg")).Nothing;
var Pair = (_require("//compiler/prelude.jg")).Pair;
var Left = (_require("//compiler/prelude.jg")).Left;
var Right = (_require("//compiler/prelude.jg")).Right;
var snd = (_require("//compiler/prelude.jg")).snd;
var splitEither = (_require("//compiler/prelude.jg")).splitEither;
var contains = (_require("//compiler/prelude.jg")).contains;
var Var = (_require("//compiler/ast.jg")).Var;
var Const = (_require("//compiler/ast.jg")).Const;
var App = (_require("//compiler/ast.jg")).App;
var Lam = (_require("//compiler/ast.jg")).Lam;
var Case = (_require("//compiler/ast.jg")).Case;
var Let = (_require("//compiler/ast.jg")).Let;
var CNum = (_require("//compiler/ast.jg")).CNum;
var CStr = (_require("//compiler/ast.jg")).CStr;
var PVar = (_require("//compiler/ast.jg")).PVar;
var PConst = (_require("//compiler/ast.jg")).PConst;
var PData = (_require("//compiler/ast.jg")).PData;
var Module = (_require("//compiler/ast.jg")).Module;
var Data = (_require("//compiler/ast.jg")).Data;
var DataCon = (_require("//compiler/ast.jg")).DataCon;
var TConst = (_require("//compiler/ast.jg")).TConst;
var TVar = (_require("//compiler/ast.jg")).TVar;
var TApp = (_require("//compiler/ast.jg")).TApp;
var TFun = (_require("//compiler/ast.jg")).TFun;
var ImportClosed = (_require("//compiler/ast.jg")).ImportClosed;
var ImportOpen = (_require("//compiler/ast.jg")).ImportOpen;
var ImportAll = (_require("//compiler/ast.jg")).ImportAll;
var Success = (_require("//compiler/parsers.jg")).Success;
var Error = (_require("//compiler/parsers.jg")).Error;
var and = (_require("//compiler/parsers.jg")).and;
var apply = (_require("//compiler/parsers.jg")).apply;
var precedes = (_require("//compiler/parsers.jg")).precedes;
var between = (_require("//compiler/parsers.jg")).between;
var or = (_require("//compiler/parsers.jg")).or;
var many = (_require("//compiler/parsers.jg")).many;
var many1 = (_require("//compiler/parsers.jg")).many1;
var sepBy1 = (_require("//compiler/parsers.jg")).sepBy1;
var upperCaseLetters = (_require("//compiler/parsers.jg")).upperCaseLetters;
var WsTok = (_require("//compiler/jaguarLexer.jg")).WsTok;
var SymTok = (_require("//compiler/jaguarLexer.jg")).SymTok;
var NumTok = (_require("//compiler/jaguarLexer.jg")).NumTok;
var StrTok = (_require("//compiler/jaguarLexer.jg")).StrTok;
var OpTok = (_require("//compiler/jaguarLexer.jg")).OpTok;
var IdTok = (_require("//compiler/jaguarLexer.jg")).IdTok;
var ComTok = (_require("//compiler/jaguarLexer.jg")).ComTok;
var Token = (_require("//compiler/jaguarLexer.jg")).Token;
var tokenize = (_require("//compiler/jaguarLexer.jg")).tokenize;
var $ParserState = function($0,$1,$2,$3){this.$0=$0;this.$1=$1;this.$2=$2;this.$3=$3;this.$tag="ParserState"};
var ParserState = function($0){return function($1){return function($2){return function($3){return new $ParserState($0,$1,$2,$3)}}}};
ParserState.$tag = "ParserState";
var mkParserState = function(ts){return (((ParserState(ts))(0))((function(){var $pm = (get(0))(ts);return ($pm.$tag==Token.$tag)?((function(t,v,l,c){return c})($pm.$0,$pm.$1,$pm.$2,$pm.$3)):(error("pattern match fail"))})()))((push(0))(emptyArray))};
var filterWhitespaceAndComments = filter(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==WsTok.$tag))?((function(v,l,c){return false})($pm.$1,$pm.$2,$pm.$3)):((($pm.$tag==Token.$tag)&&($pm.$0.$tag==ComTok.$tag))?((function(v,l,c){return false})($pm.$1,$pm.$2,$pm.$3)):((function(t){return true})($pm)))})()});
var runParser = function(p){return function(s){return (function(){var $pm = tokenize(s);return ($pm.$tag==Success.$tag)?((function(ts,s){return p(mkParserState(filterWhitespaceAndComments(ts)))})($pm.$0,$pm.$1)):((function(e){return e})($pm))})()}};
var parseToken = function(f){return function(s){return (function(){var $pm = s;return ($pm.$tag==ParserState.$tag)?((function(ts,p,li,ri){return (function(){var $pm = ($lt(p))(length(ts));return (!$pm)?((function(){return Error("run out of tokens")})()):($pm?((function(){return (function(){var $pm = (get(p))(ts);return ($pm.$tag==Token.$tag)?((function(t,v,l,c){return (function(){var $pm = ($lt(c))(ri);return $pm?((function(){return Error("token not indented sufficiently")})()):((!$pm)?((function(){return (function(){var $pm = f((get(p))(ts));return ($pm.$tag==Nothing.$tag)?((function(){return Error("parser fun failed")})()):(($pm.$tag==Just.$tag)?((function(r){return (function(){var $pm = ($lt(($add(p))(1)))(length(ts));return (!$pm)?((function(){return (Success(r))((((ParserState(ts))(($add(p))(1)))(li))(ri))})()):($pm?((function(){return (function(){var $pm = (get(($add(p))(1)))(ts);return ($pm.$tag==Token.$tag)?((function(t,v,l2,c){return (function(){var $pm = ($gt(l2))(l);return (!$pm)?((function(){return (Success(r))((((ParserState(ts))(($add(p))(1)))(li))(ri))})()):($pm?((function(){return (Success(r))((((ParserState(ts))(($add(p))(1)))(c))(ri))})()):(error("pattern match fail")))})()})($pm.$0,$pm.$1,$pm.$2,$pm.$3)):(error("pattern match fail"))})()})()):(error("pattern match fail")))})()})($pm.$0)):(error("pattern match fail")))})()})()):(error("pattern match fail")))})()})($pm.$0,$pm.$1,$pm.$2,$pm.$3)):(error("pattern match fail"))})()})()):(error("pattern match fail")))})()})($pm.$0,$pm.$1,$pm.$2,$pm.$3)):(error("pattern match fail"))})()}};
var andIndent = function(a){return function(b){return function(s){return (function(){var $pm = s;return ($pm.$tag==ParserState.$tag)?((function(ts,p,li,ri){return (function(){var $pm = a(s);return (($pm.$tag==Success.$tag)&&($pm.$1.$tag==ParserState.$tag))?((function(a,ts,p2,li2,ri2){return (function(){var $pm = b((((ParserState(ts))(p2))(li2))(($add(li))(1)));return (($pm.$tag==Success.$tag)&&($pm.$1.$tag==ParserState.$tag))?((function(b,ts,p3,li3,ri3){return (Success((Pair(a))(b)))((((ParserState(ts))(p3))(li3))(ri))})($pm.$0,$pm.$1.$0,$pm.$1.$1,$pm.$1.$2,$pm.$1.$3)):((function(e){return e})($pm))})()})($pm.$0,$pm.$1.$0,$pm.$1.$1,$pm.$1.$2,$pm.$1.$3)):((function(e){return e})($pm))})()})($pm.$0,$pm.$1,$pm.$2,$pm.$3)):(error("pattern match fail"))})()}}};
var reserved = (push("let"))((push("in"))((push("from"))((push("import"))((push("case"))((push("of"))((push("data"))(emptyArray)))))));
var symP = function(s){return parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==SymTok.$tag))?((function(v,i,c){return (function(){var $pm = ($eq(v))(s);return $pm?((function(){return Just(s)})()):((!$pm)?((function(){return Nothing})()):(error("pattern match fail")))})()})($pm.$1,$pm.$2,$pm.$3)):((function(x){return Nothing})($pm))})()})};
var operatorP = function(s){return parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==OpTok.$tag))?((function(v,i,c){return (function(){var $pm = ($eq(v))(s);return $pm?((function(){return Just(s)})()):((!$pm)?((function(){return Nothing})()):(error("pattern match fail")))})()})($pm.$1,$pm.$2,$pm.$3)):((function(x){return Nothing})($pm))})()})};
var anyOpP = parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==OpTok.$tag))?((function(v,i,c){return Just(v)})($pm.$1,$pm.$2,$pm.$3)):((function(x){return Nothing})($pm))})()});
var reservedP = function(s){return parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==IdTok.$tag))?((function(v,i,c){return (function(){var $pm = ($eq(v))(s);return $pm?((function(){return Just(s)})()):((!$pm)?((function(){return Nothing})()):(error("pattern match fail")))})()})($pm.$1,$pm.$2,$pm.$3)):((function(x){return Nothing})($pm))})()})};
var nonReservedP = parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==IdTok.$tag))?((function(v,l,c){return (function(){var $pm = (contains(v))(reserved);return $pm?((function(){return Nothing})()):((!$pm)?((function(){return Just(v)})()):(error("pattern match fail")))})()})($pm.$1,$pm.$2,$pm.$3)):((function(x){return Nothing})($pm))})()});
var upperCaseId = parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==IdTok.$tag))?((function(v,i,c){return (function(){var $pm = (contains((get(0))(v)))(upperCaseLetters);return $pm?((function(){return Just(v)})()):((!$pm)?((function(){return Nothing})()):(error("pattern match fail")))})()})($pm.$1,$pm.$2,$pm.$3)):((function(t){return Nothing})($pm))})()});
var notUpperCaseId = parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==IdTok.$tag))?((function(v,i,c){return (function(){var $pm = (contains((get(0))(v)))(upperCaseLetters);return (!$pm)?((function(){return (function(){var $pm = (contains(v))(reserved);return (!$pm)?((function(){return Just(v)})()):($pm?((function(){return Nothing})()):(error("pattern match fail")))})()})()):($pm?((function(){return Nothing})()):(error("pattern match fail")))})()})($pm.$1,$pm.$2,$pm.$3)):((function(t){return Nothing})($pm))})()});
var parenP = function(p){return ((between(symP("(")))(p))(symP(")"))};
var varP = parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==IdTok.$tag))?((function(v,l,c){return (function(){var $pm = (contains(v))(reserved);return $pm?((function(){return Nothing})()):((!$pm)?((function(){return Just(Var(v))})()):(error("pattern match fail")))})()})($pm.$1,$pm.$2,$pm.$3)):((function(x){return Nothing})($pm))})()});
var cnumP = parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==NumTok.$tag))?((function(v,l,c){return Just(Const(CNum(unsafeStringToInt(v))))})($pm.$1,$pm.$2,$pm.$3)):((function(x){return Nothing})($pm))})()});
var cstrP = parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==StrTok.$tag))?((function(v,l,c){return Just(Const(CStr(v)))})($pm.$1,$pm.$2,$pm.$3)):((function(x){return Nothing})($pm))})()});
var constP = (or(cstrP))(cnumP);
var simpleExprP = function(s){return ((or(varP))((or(constP))(parenP(exprP))))(s)};
var appP = function(s){return ((apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(f,as){return ((foldl(function(f){return function(a){return (App(f))(a)}}))(f))(as)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((andIndent((or(varP))(parenP(exprP))))(many(simpleExprP))))(s)};
var lamP = function(s){return ((apply(function(p){return (function(){var $pm = p;return (($pm.$tag==Pair.$tag)&&($pm.$1.$tag==Pair.$tag))?((function(_,ps,a){return ((foldr(function(a){return function(p){return (Lam(p))(a)}}))(a))(ps)})($pm.$0,$pm.$1.$0,$pm.$1.$1)):(error("pattern match fail"))})()}))((andIndent(symP("\\")))((and(many1(notUpperCaseId)))((precedes(operatorP("->")))(exprP)))))(s)};
var pvarP = (apply(PVar))(notUpperCaseId);
var pcnumP = parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==NumTok.$tag))?((function(v,l,c){return Just(PConst(CNum(unsafeStringToInt(v))))})($pm.$1,$pm.$2,$pm.$3)):((function(x){return Nothing})($pm))})()});
var pcstrP = parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==StrTok.$tag))?((function(v,l,c){return Just(PConst(CStr(v)))})($pm.$1,$pm.$2,$pm.$3)):((function(x){return Nothing})($pm))})()});
var strP = parseToken(function(t){return (function(){var $pm = t;return (($pm.$tag==Token.$tag)&&($pm.$0.$tag==StrTok.$tag))?((function(v,l,c){return Just(v)})($pm.$1,$pm.$2,$pm.$3)):((function(x){return Nothing})($pm))})()});
var pconstP = (or(pcnumP))(pcstrP);
var pdataP = function(s){return ((apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(n,ps){return (PData(n))(ps)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((andIndent(upperCaseId))(many((or(pvarP))((or(pconstP))(parenP(patP)))))))(s)};
var patP = (or(pvarP))((or(pconstP))(pdataP));
var ofP = function(s){return ((andIndent(patP))((precedes(operatorP("->")))(exprP)))(s)};
var caseP = (apply(function(p){return (function(){var $pm = p;return (($pm.$tag==Pair.$tag)&&($pm.$1.$tag==Pair.$tag))?((function(_,e,ps){return (Case(e))(ps)})($pm.$0,$pm.$1.$0,$pm.$1.$1)):(error("pattern match fail"))})()}))((andIndent(reservedP("case")))((and(simpleExprP))((precedes(reservedP("of")))(many1(ofP)))));
var defP = (apply(function(p){return (function(){var $pm = p;return (($pm.$tag==Pair.$tag)&&($pm.$0.$tag==Pair.$tag))?((function(n,ps,e){return (Pair(n))(((foldr(function(e){return function(p){return (Lam(p))(e)}}))(e))(ps))})($pm.$0.$0,$pm.$0.$1,$pm.$1)):(error("pattern match fail"))})()}))((andIndent((andIndent(notUpperCaseId))(many(notUpperCaseId))))((precedes(operatorP("=")))(function(s){return exprP(s)})));
var letDefsP = (apply(snd))((andIndent(reservedP("let")))(many1(defP)));
var letInP = function(s){return ((precedes(reservedP("in")))(exprP))(s)};
var letP = (apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(ds,e){return (Let(ds))(e)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((and(letDefsP))(letInP));
var primaryExprP = function(s){return ((or(appP))((or(constP))((or(lamP))((or(caseP))(letP)))))(s)};
var exprP = (apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(e,oes){return ((foldl(function(a){return function(ob){return (function(){var $pm = ob;return ($pm.$tag==Pair.$tag)?((function(op,b){return (App((App(Var(op)))(a)))(b)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}}))(e))(oes)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((andIndent(primaryExprP))(many((and(anyOpP))(primaryExprP))));
var tconstP = (apply(TConst))(upperCaseId);
var tvarP = (apply(TVar))(notUpperCaseId);
var simpleTypeP = function(s){return ((or(tconstP))((or(tvarP))(parenP(typeP))))(s)};
var tappP = (apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(t,ts){return ((foldl(function(a){return function(b){return (TApp(a))(b)}}))(t))(ts)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((andIndent(simpleTypeP))(many(simpleTypeP)));
var tfunP = (apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(t,ts){return (foldr1(function(b){return function(a){return (TFun(a))(b)}}))((enqueue(t))(ts))})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((andIndent(tappP))(many((precedes(operatorP("->")))(tappP))));
var typeP = tfunP;
var dataConP = (apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(n,ts){return (DataCon(n))(ts)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((andIndent(upperCaseId))(many(simpleTypeP)));
var dataP = (apply(function(r){return (function(){var $pm = r;return (($pm.$tag==Pair.$tag)&&(($pm.$1.$tag==Pair.$tag)&&($pm.$1.$1.$tag==Pair.$tag)))?((function(_,n,ps,cs){return ((Data(n))(ps))(cs)})($pm.$0,$pm.$1.$0,$pm.$1.$1.$0,$pm.$1.$1.$1)):(error("pattern match fail"))})()}))((andIndent(reservedP("data")))((and(upperCaseId))((and(many(notUpperCaseId)))((precedes(operatorP("=")))((sepBy1(dataConP))(operatorP("|")))))));
var importClosedP = (apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(n,f){return (ImportClosed(f))(n)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((and(nonReservedP))((precedes(reservedP("from")))(strP)));
var importOpenP = (apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(ns,f){return (ImportOpen(f))(ns)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((and(((between(symP("{")))((sepBy1(nonReservedP))(symP(","))))(symP("}"))))((precedes(reservedP("from")))(strP)));
var importAllP = (apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(n,f){return ImportAll(f)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((and(operatorP("*")))((precedes(reservedP("from")))(strP)));
var importP = (apply(snd))((andIndent(reservedP("import")))((or(importClosedP))((or(importOpenP))(importAllP))));
var moduleP = (apply(function(p){return (function(){var $pm = p;return ($pm.$tag==Pair.$tag)?((function(is,es){return (function(){var $pm = splitEither(es);return ($pm.$tag==Pair.$tag)?((function(dts,dfs){return ((Module(is))(dts))(dfs)})($pm.$0,$pm.$1)):(error("pattern match fail"))})()})($pm.$0,$pm.$1)):(error("pattern match fail"))})()}))((and(many(importP)))(many1((or((apply(Left))(dataP)))((apply(Right))(defP)))));
var parseModule = runParser(moduleP);
var parseImports = runParser(many(importP));
var parseExpr = runParser(exprP);
var exports = {ParserState:ParserState,mkParserState:mkParserState,filterWhitespaceAndComments:filterWhitespaceAndComments,runParser:runParser,parseToken:parseToken,andIndent:andIndent,reserved:reserved,symP:symP,operatorP:operatorP,anyOpP:anyOpP,reservedP:reservedP,nonReservedP:nonReservedP,upperCaseId:upperCaseId,notUpperCaseId:notUpperCaseId,parenP:parenP,varP:varP,cnumP:cnumP,cstrP:cstrP,constP:constP,simpleExprP:simpleExprP,appP:appP,lamP:lamP,pvarP:pvarP,pcnumP:pcnumP,pcstrP:pcstrP,strP:strP,pconstP:pconstP,pdataP:pdataP,patP:patP,ofP:ofP,caseP:caseP,defP:defP,letDefsP:letDefsP,letInP:letInP,letP:letP,primaryExprP:primaryExprP,exprP:exprP,tconstP:tconstP,tvarP:tvarP,simpleTypeP:simpleTypeP,tappP:tappP,tfunP:tfunP,typeP:typeP,dataConP:dataConP,dataP:dataP,importClosedP:importClosedP,importOpenP:importOpenP,importAllP:importAllP,importP:importP,moduleP:moduleP,parseModule:parseModule,parseImports:parseImports,parseExpr:parseExpr}
return exports;})();
cache["//compiler/js/backend.jg"] = (function() {var map = (_require("./builtins.js")).map;
var join = (_require("//compiler/prelude.jg")).join;
var jaguarExprToJsExpr = (_require("//compiler/js/jaguarToJs.jg")).jaguarExprToJsExpr;
var moduleToJs = (_require("//compiler/js/jaguarToJs.jg")).moduleToJs;
var jsExprToString = (_require("//compiler/js/printer.jg")).jsExprToString;
var jsStmtToString = (_require("//compiler/js/printer.jg")).jsStmtToString;
var rewriteStmt = (_require("//compiler/js/deadCode.jg")).rewriteStmt;
var compileExpr = function(e){return jsExprToString(jaguarExprToJsExpr(e))};
var compileModule = function(importSymbols){return function(m){return (join((map(jsStmtToString))((map(rewriteStmt))((moduleToJs(importSymbols))(m)))))(";\n")}};
var exports = {compileExpr:compileExpr,compileModule:compileModule}
return exports;})();
cache["compiler/compiler.jg"] = (function() {var push = (_require("./builtins.js")).push;
var map = (_require("./builtins.js")).map;
var error = (_require("./builtins.js")).error;
var Success = (_require("//compiler/parsers.jg")).Success;
var Module = (_require("//compiler/ast.jg")).Module;
var ImportClosed = (_require("//compiler/ast.jg")).ImportClosed;
var ImportOpen = (_require("//compiler/ast.jg")).ImportOpen;
var ImportAll = (_require("//compiler/ast.jg")).ImportAll;
var getExports = (_require("//compiler/ast.jg")).getExports;
var parseExpr = (_require("//compiler/jaguarParser.jg")).parseExpr;
var parseModule = (_require("//compiler/jaguarParser.jg")).parseModule;
var compileExpr = (_require("//compiler/js/backend.jg")).compileExpr;
var compileModule = (_require("//compiler/js/backend.jg")).compileModule;
var transpileExpr = function(s){return (function(){var $pm = parseExpr(s);return ($pm.$tag==Success.$tag)?((function(e,ps){return compileExpr(e)})($pm.$0,$pm.$1)):((function(e){return error(e)})($pm))})()};
var transpileModule = function(importSymbols){return function(s){return (function(){var $pm = parseModule(s);return ($pm.$tag==Success.$tag)?((function(m,ps){return (compileModule(importSymbols))(m)})($pm.$0,$pm.$1)):((function(e){return error(e)})($pm))})()}};
var importFileName = function(i){return (function(){var $pm = i;return ($pm.$tag==ImportAll.$tag)?((function(f){return f})($pm.$0)):(($pm.$tag==ImportOpen.$tag)?((function(f,ns){return f})($pm.$0,$pm.$1)):(($pm.$tag==ImportClosed.$tag)?((function(f,n){return f})($pm.$0,$pm.$1)):(error("pattern match fail"))))})()};
var findImports = function(s){return (function(){var $pm = parseModule(s);return (($pm.$tag==Success.$tag)&&($pm.$0.$tag==Module.$tag))?((function(is,ds,vs,ps){return (push("./builtins.js"))((map(importFileName))(is))})($pm.$0.$0,$pm.$0.$1,$pm.$0.$2,$pm.$1)):((function(e){return error(e)})($pm))})()};
var findExports = function(s){return (function(){var $pm = parseModule(s);return ($pm.$tag==Success.$tag)?((function(m,ps){return getExports(m)})($pm.$0,$pm.$1)):((function(e){return error(e)})($pm))})()};
var exports = {transpileExpr:transpileExpr,transpileModule:transpileModule,importFileName:importFileName,findImports:findImports,findExports:findExports}
return exports;})();
module.exports = cache["compiler/compiler.jg"]